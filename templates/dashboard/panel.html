{% extends "base_templates/dashboard_page.html" %}
{% block title %} Dashboard {% endblock %}


{% block content%}

<div class="container">
  <h1 class="text-dark" style="text-decoration-line:underline;" align="center"> Dashboard</h1>
  <hr>
  <div class="row justify-content-around">
    <div class="card" style="width: 18rem;">
      <div class="card-body">
        <h5 class="card-title">Total visits: </h5>
        <p class="card-text">{{analyticsUsage.totalVisits}}</p>
      </div>
    </div>
    <div class="card" style="width: 18rem;">
      <div class="card-body">
        <h5 class="card-title">Most Visited Page</h5>
        <p class="card-text">{{analyticsUsage.mostVisitedPage}}</p>
      </div>
    </div>
    <div class="card" style="width: 18rem;">
      <div class="card-body">
        <h5 class="card-title">Unique visitors: </h5>
        <p class="card-text">{{analyticsUsage.visitorCount}}</p>
      </div>
    </div>
  </div>


  <div class="row justify-content-around">
    <div class="row">
      <a class="btn btn-primary" href="{{url_for('users.add_user')}}" role="button" id="addUser">Add user</a>
      <a class="btn btn-primary" href="{{url_for('users.list_users')}}" id="seeUser" role="button">See users</a>
    </div>
    <div class="row">
      <a id="editPage" class="btn btn-primary" href="{{url_for('content.edit_content')}}"role="button">Edit main page content</a>
    </div>
  </div>
  <br>

  <div class="row justify-content-around">
    <div class="card">
      <canvas class="my-4 w-100" id="weekly_usage" width="450" height="380"></canvas>
    </div>
    <div class="card">
      <canvas class="my-4 w-100" id="systems" width="450" height="380"></canvas>
    </div>
  </div>


</div>

<!-- Graphs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
<script>
  var ctx = document.getElementById("weekly_usage");
  var weekly_usage = new Chart(ctx, {
    type: 'line',
    data: {
      labels: [
        '{{analyticsUsage.weekData['6'].date}}',
        '{{analyticsUsage.weekData['5'].date}}',
        '{{analyticsUsage.weekData['4'].date}}',
        '{{analyticsUsage.weekData['3'].date}}',
        '{{analyticsUsage.weekData['2'].date}}',
        '{{analyticsUsage.weekData['1'].date}}',
        '{{analyticsUsage.weekData['today'].date}}'
      ],
      datasets: [{
        data: [
          {{analyticsUsage.weekData['6'].count}},
          {{analyticsUsage.weekData['5'].count}},
          {{analyticsUsage.weekData['4'].count}},
          {{analyticsUsage.weekData['3'].count}},
          {{analyticsUsage.weekData['2'].count}},
          {{analyticsUsage.weekData['1'].count}},
          {{analyticsUsage.weekData['today'].count}}
        ],
        lineTension: 0,
        backgroundColor: 'transparent',
        borderColor: '#007bff',
        borderWidth: 4,
        pointBackgroundColor: '#007bff'
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: false
          }
        }]
      },
      legend: {
        display: false,
      }
    }
  });

  var ctxP = document.getElementById("systems").getContext('2d');
  var systems = new Chart(ctxP, {
    type: 'pie',
    data: {
      labels: ["Windows", "MacOS", "Mobile"],
      datasets: [{
        data: [
          {{analyticsUsage.windowsCount}},
          {{analyticsUsage.macCount}},
          {{analyticsUsage.mobileCount}}
        ],
        backgroundColor: ["#F7464A", "#46BFBD", "#FDB45C"],
        hoverBackgroundColor: ["#FF5A5E", "#5AD3D1", "#FFC870"]
      }]
    },
    options: {
      responsive: true
    }
  });
</script>

{% endblock %}
